<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Potential Profile™ - Complete Assessment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #2d3748;
            background: linear-gradient(135deg, #8B7B6B 0%, #A8998A 25%, #6B7B5A 75%, #5A6B4A 100%);
            min-height: 100vh;
            padding: 10px;
            /* iframe optimizations */
            overflow-x: hidden;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .hero {
            text-align: center;
            margin-bottom: 50px;
            color: white;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
        }

        .hero p {
            font-size: 1.4rem;
            font-weight: 500;
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto;
        }

        .assessment-intro {
            background: rgba(255, 255, 255, 0.95);
            padding: 60px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .intro-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #8B7B6B;
            margin-bottom: 20px;
        }

        .intro-content {
            font-size: 1.2rem;
            color: #4a5568;
            margin-bottom: 40px;
            font-weight: 500;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin-bottom: 40px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #8B7B6B, #6B7B5A);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .start-btn {
            background: linear-gradient(135deg, #8B7B6B, #6B7B5A);
            color: white;
            padding: 20px 50px;
            border: none;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(139, 123, 107, 0.3);
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(139, 123, 107, 0.4);
        }

        .user-info-page {
            background: rgba(255, 255, 255, 0.95);
            padding: 60px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            display: none;
        }

        .form-title {
            font-size: 2rem;
            font-weight: 700;
            color: #8B7B6B;
            margin-bottom: 12px;
            text-align: center;
        }

        .form-subtitle {
            color: #718096;
            margin-bottom: 40px;
            text-align: center;
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 28px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .form-group input {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .form-group input:focus {
            outline: none;
            border-color: #8B7B6B;
            box-shadow: 0 0 0 4px rgba(139, 123, 107, 0.1);
            transform: translateY(-1px);
        }

        .required {
            color: #e53e3e;
        }

        .btn {
            background: linear-gradient(135deg, #8B7B6B, #6B7B5A);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(139, 123, 107, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 4px 15px rgba(139, 123, 107, 0.2);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #718096, #4a5568);
            box-shadow: 0 8px 25px rgba(113, 128, 150, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(139, 123, 107, 0.4);
        }

        .assessment-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 50px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            display: none;
        }

        .progress-container {
            margin-bottom: 40px;
            text-align: center;
        }

        .progress-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #8B7B6B, #6B7B5A);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            color: #718096;
            font-weight: 600;
        }

        .section-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px solid #f1f5f9;
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #8B7B6B;
            margin-bottom: 12px;
        }

        .section-subtitle {
            color: #718096;
            font-size: 1.1rem;
        }

        .page-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 25px rgba(0,0,0,0.08);
            border-left: 5px solid #8B7B6B;
            margin-bottom: 30px;
        }

        .question-item {
            margin-bottom: 35px;
            padding-bottom: 30px;
            border-bottom: 1px solid #f1f5f9;
        }

        .question-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .question-number {
            color: #8B7B6B;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .options-container {
            display: grid;
            gap: 15px;
        }

        .option {
            padding: 18px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-size: 1rem;
            line-height: 1.5;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .option:hover {
            border-color: #8B7B6B;
            background: rgba(139, 123, 107, 0.04);
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #8B7B6B;
            background: rgba(139, 123, 107, 0.1);
            font-weight: 600;
        }

        .option-circle {
            width: 20px;
            height: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 50%;
            flex-shrink: 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .option:hover .option-circle {
            border-color: #8B7B6B;
        }

        .option.selected .option-circle {
            border-color: #8B7B6B;
            background: white;
        }

        .option.selected .option-circle::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            background: #8B7B6B;
            border-radius: 50%;
        }

        .option-text {
            flex: 1;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
        }

        .loading-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 80px 60px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            text-align: center;
            display: none;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid #8B7B6B;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 30px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.3rem;
            color: #4a5568;
            font-weight: 600;
        }

        .results-page {
            background: rgba(255, 255, 255, 0.95);
            padding: 60px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            display: none;
        }

        .results-header {
            text-align: center;
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 2px solid #f1f5f9;
        }

        .profile-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #8B7B6B, #6B7B5A);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .profile-badge {
            font-size: 1.2rem;
            color: #718096;
            margin-bottom: 10px;
        }

        .primary-profile-display {
            font-size: 2rem;
            font-weight: 700;
            color: #8B7B6B;
            margin-bottom: 20px;
        }

        .profile-insight {
            font-size: 1.2rem;
            color: #4a5568;
            font-style: italic;
        }

        .profile-breakdown {
            margin-bottom: 50px;
        }

        .breakdown-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .breakdown-item {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #8B7B6B;
        }

        .breakdown-item h4 {
            color: #8B7B6B;
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .breakdown-item p {
            color: #4a5568;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .rooted-upsell {
            background: linear-gradient(135deg, rgba(139, 123, 107, 0.1), rgba(107, 123, 90, 0.1));
            border: 3px solid #8B7B6B;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-top: 40px;
        }

        .rooted-title {
            font-size: 2rem;
            font-weight: 700;
            color: #8B7B6B;
            margin-bottom: 15px;
        }

        .rooted-subtitle {
            font-size: 1.3rem;
            color: #4a5568;
            margin-bottom: 30px;
        }

        .rooted-value {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .rooted-cta-btn {
            background: linear-gradient(135deg, #8B7B6B, #6B7B5A);
            color: white;
            padding: 20px 50px;
            border: none;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(139, 123, 107, 0.3);
            margin-bottom: 20px;
        }

        .rooted-cta-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(139, 123, 107, 0.4);
        }

        .detailed-results-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .detailed-results-content {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .detailed-close-btn {
            position: absolute;
            top: 20px;
            right: 25px;
            background: none;
            border: none;
            font-size: 2rem;
            color: #718096;
            cursor: pointer;
            line-height: 1;
        }

        .detailed-close-btn:hover {
            color: #8B7B6B;
        }

        .detailed-title {
            color: #8B7B6B;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
        }

        .detailed-section {
            margin-bottom: 35px;
            padding: 25px;
            background: rgba(139, 123, 107, 0.05);
            border-radius: 15px;
            border-left: 4px solid #8B7B6B;
        }

        .detailed-section h3 {
            color: #8B7B6B;
            font-size: 1.3rem;
            margin-bottom: 15px;
        }

        .detailed-section p {
            color: #4a5568;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .scores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .score-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .score-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #8B7B6B;
        }

        .score-label {
            font-size: 0.9rem;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            .assessment-intro, .user-info-page, .assessment-container, .results-page { padding: 30px 25px; }
            .stats { gap: 30px; }
            .breakdown-grid { grid-template-columns: 1fr; }
            .detailed-results-content {
                margin: 10px;
                padding: 25px;
            }
            
            .scores-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- ACCESS CODE VALIDATION SCREEN -->
    <div id="accessCodeScreen" class="container" style="max-width: 600px; margin-top: 100px;">
        <div class="assessment-intro">
            <div style="display: inline-block; background: linear-gradient(135deg, #8B7B6B, #6B7B5A); color: white; padding: 8px 20px; border-radius: 20px; font-size: 0.9rem; font-weight: 600; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px;">
                🎯 ROOTED COHORT ACCESS
            </div>
            <h2 class="intro-title">Welcome to Your Potential Profile™</h2>
            <div class="intro-content" style="margin-bottom: 30px;">
                Enter your unique access code to begin your transformational assessment
            </div>
            
            <div id="accessCodeError" style="display: none; background: #FEE2E2; border: 2px solid #EF4444; color: #991B1B; padding: 15px 20px; border-radius: 10px; margin-bottom: 20px; font-weight: 500;"></div>
            
            <form id="accessCodeForm" onsubmit="validateAccessCode(event)">
                <div class="form-group">
                    <label>Access Code <span class="required">*</span></label>
                    <input 
                        type="text" 
                        id="accessCodeInput" 
                        placeholder="ROOTED-JAN2025-001" 
                        required
                        autocomplete="off"
                        style="text-transform: uppercase; text-align: center; font-size: 1.2rem; font-weight: 600;"
                    >
                </div>
                
                <button type="submit" class="btn" id="validateBtn" style="width: 100%;">
                    Validate & Continue
                </button>
            </form>
            
            <p style="margin-top: 30px; color: #718096; font-size: 0.95rem; text-align: center;">
                💡 Your access code was provided by your cohort facilitator
            </p>
        </div>
    </div>

    <div class="container" id="mainAssessment" style="display: none;">
        <!-- Hero Section -->
        <div class="hero">
            <h1>Potential Profile™</h1>
            <p>Discover your complete potential blueprint - how you're wired to build, lead, and live at full capacity</p>
        </div>

        <!-- Assessment Introduction -->
        <div id="introPage" class="assessment-intro">
            <h2 class="intro-title">Your Complete Potential Blueprint</h2>
            <div class="intro-content">
                This comprehensive assessment reveals your natural leadership wiring, navigation style, operating zone, clarity quotient, and growth catalysts. Unlike personality tests that categorize, this uncovers your unique pathway to operating at full potential.
            </div>
            
            <div class="stats">
                <div class="stat">
                    <span class="stat-number">16</span>
                    <span class="stat-label">Potential Profiles</span>
                </div>
                <div class="stat">
                    <span class="stat-number">50</span>
                    <span class="stat-label">Strategic Questions</span>
                </div>
                <div class="stat">
                    <span class="stat-number">25</span>
                    <span class="stat-label">Minutes</span>
                </div>
            </div>
            
            <button class="start-btn" onclick="showUserInfo()">
                Discover Your Complete Potential
            </button>
        </div>

        <!-- User Information Page -->
        <div id="userInfoPage" class="user-info-page">
            <h2 class="form-title">Your Information</h2>
            <p class="form-subtitle">This assessment takes a minimum of 25 minutes to complete. Find a quiet space where you can focus.</p>
            
            <form id="userInfoForm">
                <div class="form-group">
                    <label for="userName">Full Name <span class="required">*</span></label>
                    <input type="text" id="userName" required placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label for="userEmail">Email Address <span class="required">*</span></label>
                    <input type="email" id="userEmail" required placeholder="your.email@example.com">
                </div>
                
                <button type="button" class="btn" style="width: 100%; margin-top: 20px;" onclick="startAssessment()">
                    Begin Assessment
                </button>
                
                <p style="text-align: center; margin-top: 20px; color: #718096; font-size: 0.95rem;">
                    Takes 25 minutes • Your information is secure and will only be used to deliver your results
                </p>
            </form>
        </div>

        <!-- Assessment Container -->
        <div id="assessmentContainer" class="assessment-container">
            <div id="top-anchor"></div>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">Page 1 of 10</div>
            </div>

            <div class="section-header" id="sectionHeader">
                <h2 class="section-title" id="sectionTitle">Natural Impact Patterns</h2>
                <p class="section-subtitle" id="sectionSubtitle">How you naturally create meaningful results and influence</p>
            </div>
            
            <div class="page-container" id="pageContainer">
                <!-- Questions will be dynamically loaded here -->
            </div>
            
            <div class="navigation">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousPage()" style="visibility: hidden;">
                    Previous
                </button>
                <button class="btn" id="nextBtn" onclick="nextPage()" disabled>
                    Next Page
                </button>
            </div>
        </div>

        <!-- Loading Screen -->
        <div id="loadingContainer" class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">Analyzing your complete potential profile...</div>
            <p style="margin-top: 20px; color: #718096;">
                Processing your responses across 5 dimensions to create your personalized blueprint.
            </p>
        </div>

        <!-- Results Page -->
        <div id="resultsPage" class="results-page">
            <div class="results-header">
                <h1 class="profile-title">Your Potential Profile™ Results</h1>
                <div class="profile-badge">
                    <span id="userNameDisplay">Your Name</span>, you are a
                </div>
                <div class="primary-profile-display" id="profileDisplay">Builder + Depth Navigator</div>
                <p class="profile-insight" id="profileInsight">
                    You have incredible capacity for creating lasting impact through systematic approaches.
                </p>
            </div>

            <div class="profile-breakdown">
                <div class="breakdown-grid" id="breakdownGrid">
                    <!-- Profile breakdown will be populated here -->
                </div>
            </div>

            <div style="text-align: center; margin-top: 50px; padding: 40px; background: linear-gradient(135deg, rgba(139, 123, 107, 0.1), rgba(107, 123, 90, 0.1)); border: 2px solid #8B7B6B; border-radius: 20px;">
                <h2 style="color: #8B7B6B; margin-bottom: 20px; font-size: 2rem;">🎉 Thank You for Completing Your Assessment!</h2>
                <p style="font-size: 1.2rem; color: #4a5568; max-width: 600px; margin: 0 auto 25px;">
                    Your comprehensive Potential Profile™ has been saved and will be reviewed by your facilitator.
                </p>
                <p style="font-size: 1.1rem; color: #718096; margin-bottom: 25px;">
                    <strong>During your first ROOTED session</strong>, you'll receive a detailed breakdown of your results, including:<br>
                    • Your complete archetype and navigator analysis<br>
                    • Personalized insights for your unique profile<br>
                    • Actionable strategies to unlock your full potential
                </p>
                
                <div style="background: white; padding: 25px; border-radius: 12px; margin: 25px auto; max-width: 500px;">
                    <p style="color: #8B7B6B; font-weight: 600; margin-bottom: 5px;">Preview Your Results</p>
                    <p style="color: #4a5568; font-size: 0.95rem; margin-bottom: 15px;">
                        View your profile overview below. Your facilitator will provide the complete analysis during Week 1.
                    </p>
                    <button class="btn" style="padding: 12px 25px; font-size: 0.95rem;" onclick="showDetailedResults()">
                        View Detailed Results Now
                    </button>
                </div>
                
                <p style="margin-top: 25px; color: #718096; font-size: 0.95rem;">
                    Questions before your first session? Reach out to <strong>info@empowerpotential.co</strong>
                </p>
            </div>
        </div>

        <!-- Detailed Results Modal -->
        <div id="detailedResultsModal" class="detailed-results-modal">
            <div class="detailed-results-content">
                <button class="detailed-close-btn" onclick="closeDetailedResults()">&times;</button>
                
                <h2 class="detailed-title">Your Complete Potential Analysis</h2>
                
                <div class="detailed-section">
                    <h3>Your Profile Combination</h3>
                    <p id="detailedProfileTitle"><strong>The Master Architect</strong></p>
                    <p id="detailedProfileInsight">You combine visionary building capability with deep analytical thinking...</p>
                </div>

                <div class="detailed-section">
                    <h3>Archetype Breakdown</h3>
                    <div class="scores-grid" id="archetypeScores">
                        <!-- Archetype scores will be populated here -->
                    </div>
                </div>

                <div class="detailed-section">
                    <h3>Navigation Style Breakdown</h3>
                    <div class="scores-grid" id="navigatorScores">
                        <!-- Navigator scores will be populated here -->
                    </div>
                </div>

                <div class="detailed-section">
                    <h3>Growth Catalyst Analysis</h3>
                    <div class="scores-grid" id="growthScores">
                        <!-- Growth scores will be populated here -->
                    </div>
                </div>

                <div class="detailed-section">
                    <h3>Key Insights</h3>
                    <p><strong>Your Authenticity Alignment:</strong> <span id="clarityInsight"></span></p>
                    <p><strong>Primary Growth Driver:</strong> <span id="growthInsight"></span></p>
                    <p><strong>Optimal Performance Zone:</strong> <span id="zoneInsight"></span></p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Initialize Supabase client
        const SUPABASE_URL = 'https://pkcdvogzdyqjtykqcirm.supabase.co'
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrY2R2b2d6ZHlxanR5a3FjaXJtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE2MTM5NzEsImV4cCI6MjA3NzE4OTk3MX0.HMDfSG4hNnQj6XwyrLsLpxQpn78Up4hpe0IGo30o-v4'
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
        
        // Cohort tracking variables
        let validatedAccessCode = null;
        let cohortBatch = null;
        
        // Core Variables
        let currentPage = 0;
        let responses = {};
        let userData = {};
        const totalPages = 10;
        const questionsPerPage = 5;
        
        // Scoring system with dual-scoring capability
        let scores = {
            // B-Archetypes (also determine Activation Patterns)
            Builder: 0, Bridger: 0, Breaker: 0, Blazer: 0,
            
            // Navigation Styles (also determine Operating Zone)
            'Depth Navigator': 0, 'Speed Navigator': 0, 'Scale Navigator': 0, 'Culture Navigator': 0,
            
            // Additional dimensions
            'Clarity Quotient': 0,
            'Growth Catalysts': { environment: 0, mentorship: 0, challenge: 0, autonomy: 0 }
        };

        // Complete 50-Question Bank with New Questions
        const questions = [
            // PAGE 1: Questions 1-5 (B-Archetype Foundation)
            {
                id: 'q1',
                text: 'When you\'re at your best, people value you most for:',
                options: {
                    a: { type: 'Builder', activation: 'systems', text: 'Building systems that work and last' },
                    b: { type: 'Blazer', activation: 'innovation', text: 'Challenging assumptions and driving breakthrough innovation' },
                    c: { type: 'Bridger', activation: 'relationships', text: 'Bringing people together and helping them collaborate' },
                    d: { type: 'Breaker', activation: 'analysis', text: 'Analyzing complex challenges and developing strategic solutions' }
                }
            },
            {
                id: 'q2',
                text: 'In high-pressure situations, you naturally focus on:',
                options: {
                    a: { type: 'Breaker', activation: 'analysis', text: 'Breaking down complexity into manageable pieces' },
                    b: { type: 'Builder', activation: 'systems', text: 'Creating systems that prevent future problems' },
                    c: { type: 'Blazer', activation: 'innovation', text: 'Finding innovative approaches that turn challenges into opportunities' },
                    d: { type: 'Bridger', activation: 'relationships', text: 'Keeping the team together and working as one' }
                }
            },
            {
                id: 'q3',
                text: 'People come to you when they need someone who can:',
                options: {
                    a: { type: 'Bridger', activation: 'relationships', text: 'Navigate tricky relationships and help everyone agree' },
                    b: { type: 'Breaker', activation: 'analysis', text: 'See patterns and strategic implications others miss entirely' },
                    c: { type: 'Builder', activation: 'systems', text: 'Turn abstract concepts into concrete, executable realities' },
                    d: { type: 'Blazer', activation: 'innovation', text: 'Challenge conventional thinking and inspire bold action' }
                }
            },
            {
                id: 'q4',
                text: 'You feel most energized when your work involves:',
                options: {
                    a: { type: 'Blazer', activation: 'innovation', text: 'Disrupting the status quo and creating new ways of thinking' },
                    b: { type: 'Bridger', activation: 'relationships', text: 'Facilitating meaningful connections between people and ideas' },
                    c: { type: 'Breaker', activation: 'analysis', text: 'Solving complex problems that require deep analytical thinking' },
                    d: { type: 'Builder', activation: 'systems', text: 'Building systems that create lasting value' }
                }
            },
            {
                id: 'q5',
                text: 'In team meetings, you naturally tend to:',
                options: {
                    a: { type: 'Builder', activation: 'systems', text: 'Organize the discussion and create clear action plans' },
                    b: { type: 'Blazer', activation: 'innovation', text: 'Ask provocative questions that shift how people think' },
                    c: { type: 'Breaker', activation: 'analysis', text: 'Provide insights that reveal the real issues' },
                    d: { type: 'Bridger', activation: 'relationships', text: 'Make sure everyone\'s voice is heard and valued' }
                }
            },

            // PAGE 2: Questions 6-10 (B-Archetype Leadership)
            {
                id: 'q6',
                text: 'When leading others, you focus most on:',
                options: {
                    a: { type: 'Breaker', activation: 'analysis', text: 'Helping people think more strategically and analytically' },
                    b: { type: 'Builder', activation: 'systems', text: 'Creating clear development plans with specific goals' },
                    c: { type: 'Blazer', activation: 'innovation', text: 'Challenging people to push past their limitations' },
                    d: { type: 'Bridger', activation: 'relationships', text: 'Understanding what each person does best and helping them grow' }
                }
            },
            {
                id: 'q7',
                text: 'When making important decisions, you prioritize:',
                options: {
                    a: { type: 'Bridger', activation: 'relationships', text: 'Getting input from everyone affected and building agreement' },
                    b: { type: 'Breaker', activation: 'analysis', text: 'Thorough analysis and solid evidence' },
                    c: { type: 'Blazer', activation: 'innovation', text: 'Bold innovation over playing it safe' },
                    d: { type: 'Builder', activation: 'systems', text: 'Long-term sustainability and practical implementation' }
                }
            },
            {
                id: 'q8',
                text: 'During major changes, you\'re naturally good at:',
                options: {
                    a: { type: 'Blazer', activation: 'innovation', text: 'Inspiring people to see new possibilities' },
                    b: { type: 'Bridger', activation: 'relationships', text: 'Building support and keeping everyone aligned' },
                    c: { type: 'Builder', activation: 'systems', text: 'Creating plans that ensure changes actually stick' },
                    d: { type: 'Breaker', activation: 'analysis', text: 'Figuring out root causes and developing smart strategies' }
                }
            },
            {
                id: 'q9',
                text: 'When you communicate, people notice you tend to:',
                options: {
                    a: { type: 'Breaker', activation: 'analysis', text: 'Use logical reasoning backed by solid evidence' },
                    b: { type: 'Blazer', activation: 'innovation', text: 'Ask challenging questions that make people think differently' },
                    c: { type: 'Builder', activation: 'systems', text: 'Paint a clear picture with organized, actionable steps' },
                    d: { type: 'Bridger', activation: 'relationships', text: 'Include everyone and make genuine connections' }
                }
            },
            {
                id: 'q10',
                text: 'Your ideal project outcome would:',
                options: {
                    a: { type: 'Builder', activation: 'systems', text: 'Create something that keeps delivering value long after you\'re done' },
                    b: { type: 'Bridger', activation: 'relationships', text: 'Strengthen relationships and improve how people work together' },
                    c: { type: 'Blazer', activation: 'innovation', text: 'Change how people think about what\'s possible' },
                    d: { type: 'Breaker', activation: 'analysis', text: 'Solve complex problems that give you a real competitive edge' }
                }
            },

            // PAGE 3: Questions 11-15 (B-Archetype Problem-Solving)
            {
                id: 'q11',
                text: 'When you hit a major obstacle, your first instinct is to:',
                options: {
                    a: { type: 'Breaker', activation: 'analysis', text: 'Analyze it carefully to find the best way through' },
                    b: { type: 'Builder', activation: 'systems', text: 'Design a system to work around or eliminate it' },
                    c: { type: 'Blazer', activation: 'innovation', text: 'Find a creative way to turn it into an opportunity' },
                    d: { type: 'Bridger', activation: 'relationships', text: 'Get everyone together to tackle it as a team' }
                }
            },
            {
                id: 'q12',
                text: 'When it comes to accountability, you believe in:',
                options: {
                    a: { type: 'Blazer', activation: 'innovation', text: 'Challenging people to push beyond what they think they can do' },
                    b: { type: 'Bridger', activation: 'relationships', text: 'Everyone being accountable to each other for team success' },
                    c: { type: 'Builder', activation: 'systems', text: 'Creating systems that make accountability feel natural' },
                    d: { type: 'Breaker', activation: 'analysis', text: 'Regular check-ins and adjustments based on actual results' }
                }
            },
            {
                id: 'q13',
                text: 'When measuring success, you care most about:',
                options: {
                    a: { type: 'Builder', activation: 'systems', text: 'Whether systems are running efficiently and improving over time' },
                    b: { type: 'Blazer', activation: 'innovation', text: 'Breakthrough moments that create real transformation' },
                    c: { type: 'Breaker', activation: 'analysis', text: 'Data that reveals important patterns and insights' },
                    d: { type: 'Bridger', activation: 'relationships', text: 'How well relationships and teamwork are functioning' }
                }
            },
            {
                id: 'q14',
                text: 'When things are uncertain, your leadership focuses on:',
                options: {
                    a: { type: 'Blazer', activation: 'innovation', text: 'Helping others see opportunity in the chaos' },
                    b: { type: 'Bridger', activation: 'relationships', text: 'Keeping the team together and supporting each other' },
                    c: { type: 'Builder', activation: 'systems', text: 'Creating stability and clear direction' },
                    d: { type: 'Breaker', activation: 'analysis', text: 'Breaking down the complexity into manageable decisions' }
                }
            },
            {
                id: 'q15',
                text: 'Your approach to solving problems typically involves:',
                options: {
                    a: { type: 'Breaker', activation: 'analysis', text: 'Analyzing root causes to understand what\'s really going on' },
                    b: { type: 'Builder', activation: 'systems', text: 'Creating comprehensive plans that solve the problem and prevent it from happening again' },
                    c: { type: 'Blazer', activation: 'innovation', text: 'Challenging assumptions to find solutions others haven\'t thought of' },
                    d: { type: 'Bridger', activation: 'relationships', text: 'Getting everyone involved to tap into collective wisdom' }
                }
            },

            // PAGE 4: Questions 16-20 (Navigation Style Foundation)
            {
                id: 'q16',
                text: 'In high-pressure, high-performance environments, you contribute by:',
                options: {
                    a: { type: 'Scale Navigator', operating: 'structured', text: 'Creating systems that help everyone perform better consistently' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Pushing boundaries and achieving breakthrough results' },
                    c: { type: 'Culture Navigator', operating: 'relational', text: 'Building teamwork that makes everyone perform better' },
                    d: { type: 'Depth Navigator', operating: 'analytical', text: 'Analyzing what\'s working and finding ways to optimize performance' }
                }
            },
            {
                id: 'q17',
                text: 'Your natural performance excellence emerges through:',
                options: {
                    a: { type: 'Depth Navigator', operating: 'analytical', text: 'Deep expertise and comprehensive understanding of complex domains' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Rapid adaptation and quick response in changing environments' },
                    c: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic approaches that create consistent, reliable results' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'Relationship-based approaches that maximize collective potential' }
                }
            },
            {
                id: 'q18',
                text: 'You create the most value when you can:',
                options: {
                    a: { type: 'Scale Navigator', operating: 'structured', text: 'Build systems that keep delivering results long after you\'re done' },
                    b: { type: 'Depth Navigator', operating: 'analytical', text: 'Develop deep expertise that solves problems others can\'t' },
                    c: { type: 'Speed Navigator', operating: 'adaptive', text: 'Move quickly to capitalize on opportunities and adapt to change' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'Create environments where people feel valued and can contribute authentically' }
                }
            },
            {
                id: 'q19',
                text: 'Your distinctive competitive advantage comes from:',
                options: {
                    a: { type: 'Speed Navigator', operating: 'adaptive', text: 'Speed of learning, adapting, and implementing solutions in real-time' },
                    b: { type: 'Depth Navigator', operating: 'analytical', text: 'Deep understanding and ability to see what others miss in complex situations' },
                    c: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic thinking that creates scalable, repeatable processes' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'Emotional intelligence and ability to navigate complex human dynamics' }
                }
            },
            {
                id: 'q20',
                text: 'You create the most meaningful impact when:',
                options: {
                    a: { type: 'Culture Navigator', operating: 'relational', text: 'Fostering authentic relationships that strengthen communities and culture' },
                    b: { type: 'Scale Navigator', operating: 'structured', text: 'Building robust systems that create lasting value and sustainable advantage' },
                    c: { type: 'Depth Navigator', operating: 'analytical', text: 'Applying deep analytical thinking to solve strategic challenges precisely' },
                    d: { type: 'Speed Navigator', operating: 'adaptive', text: 'Driving rapid innovation and helping organizations adapt quickly to opportunities' }
                }
            },

            // PAGE 5: Questions 21-25 (Navigation Style Deep Dive)
            {
                id: 'q21',
                text: 'When facing a completely new challenge, you naturally:',
                options: {
                    a: { type: 'Culture Navigator', operating: 'relational', text: 'Focus on getting everyone aligned and committed to working through it together' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Start experimenting right away to learn what works' },
                    c: { type: 'Depth Navigator', operating: 'analytical', text: 'Do thorough research to understand what you\'re dealing with' },
                    d: { type: 'Scale Navigator', operating: 'structured', text: 'Create a systematic approach with clear steps' }
                }
            },
            {
                id: 'q22',
                text: 'When making complex strategic decisions, you emphasize:',
                options: {
                    a: { type: 'Depth Navigator', operating: 'analytical', text: 'Thorough research and deep expertise before deciding' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Quick testing and course correction based on real feedback' },
                    c: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic evaluation using clear criteria and organized comparison' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'Making sure decisions align with people\'s values and impact' }
                }
            },
            {
                id: 'q23',
                text: 'When learning new domains, you prefer to:',
                options: {
                    a: { type: 'Speed Navigator', operating: 'adaptive', text: 'Jump in quickly and learn through hands-on experimentation, practice, and immediate application' },
                    b: { type: 'Culture Navigator', operating: 'relational', text: 'Learn collaboratively through relationships with experienced practitioners and mentoring connections' },
                    c: { type: 'Depth Navigator', operating: 'analytical', text: 'Master foundational principles and theoretical frameworks before moving to practical application' },
                    d: { type: 'Scale Navigator', operating: 'structured', text: 'Follow structured learning paths with organized, sequential skill development and clear milestones' }
                }
            },
            {
                id: 'q24',
                text: 'Under pressure, your decision-making relies on:',
                options: {
                    a: { type: 'Culture Navigator', operating: 'relational', text: 'Emotional intelligence and stakeholder impact considerations to guide choices under stress' },
                    b: { type: 'Depth Navigator', operating: 'analytical', text: 'Deep expertise and comprehensive understanding of implications to make informed decisions' },
                    c: { type: 'Speed Navigator', operating: 'adaptive', text: 'Quick assessment and rapid adaptive response capability to navigate changing conditions' },
                    d: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic protocols and organized decision-making frameworks to maintain consistency under pressure' }
                }
            },
            {
                id: 'q25',
                text: 'Your information processing style favors:',
                options: {
                    a: { type: 'Depth Navigator', operating: 'analytical', text: 'Comprehensive analysis with detailed understanding and thorough investigation' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Quick synthesis focused on actionable insights and rapid implementation' },
                    c: { type: 'Scale Navigator', operating: 'structured', text: 'Organized categorization with systematic, methodical evaluation' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'Relational context and emotional impact on people and community dynamics' }
                }
            },

            // PAGE 6: Questions 26-30 (Navigation Style Continued)
            {
                id: 'q26',
                text: 'When juggling competing priorities, you:',
                options: {
                    a: { type: 'Scale Navigator', operating: 'structured', text: 'Create a clear system for deciding what comes first' },
                    b: { type: 'Culture Navigator', operating: 'relational', text: 'Consider how decisions will affect people and relationships' },
                    c: { type: 'Depth Navigator', operating: 'analytical', text: 'Think through long-term consequences before prioritizing' },
                    d: { type: 'Speed Navigator', operating: 'adaptive', text: 'Make quick decisions and adjust as things change' }
                }
            },
            {
                id: 'q27',
                text: 'Your problem-solving timeframe typically involves:',
                options: {
                    a: { type: 'Speed Navigator', operating: 'adaptive', text: 'Rapid cycles of testing, learning, and quick improvement with fast feedback' },
                    b: { type: 'Depth Navigator', operating: 'analytical', text: 'Extended research phases to develop comprehensive understanding before implementing solutions' },
                    c: { type: 'Scale Navigator', operating: 'structured', text: 'Methodical phases with systematic progress toward organized milestones' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'Relationship-building phases to ensure people alignment and buy-in before major changes' }
                }
            },
            {
                id: 'q28',
                text: 'When evaluating solutions, you emphasize:',
                options: {
                    a: { type: 'Culture Navigator', operating: 'relational', text: 'People impact and long-term relationship implications in all solution evaluations' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Implementation speed and rapid market responsiveness for competitive advantage' },
                    c: { type: 'Depth Navigator', operating: 'analytical', text: 'Technical excellence and comprehensive long-term strategic soundness' },
                    d: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic implementation feasibility and organized operational efficiency' }
                }
            },
            {
                id: 'q29',
                text: 'When explaining complex ideas, you focus on:',
                options: {
                    a: { type: 'Depth Navigator', operating: 'analytical', text: 'Comprehensive explanations with thorough, accurate details' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Quick, clear summaries focused on what people can do right now' },
                    c: { type: 'Scale Navigator', operating: 'structured', text: 'Organized presentations with clear structure and logical flow' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'Making sure it resonates emotionally and connects with your audience' }
                }
            },
            {
                id: 'q30',
                text: 'When building competitive advantage, you focus on:',
                options: {
                    a: { type: 'Scale Navigator', operating: 'structured', text: 'Operational excellence and systematic efficiency optimization that creates sustainable differentiation' },
                    b: { type: 'Depth Navigator', operating: 'analytical', text: 'Deep expertise and comprehensive knowledge that competitors cannot match' },
                    c: { type: 'Speed Navigator', operating: 'adaptive', text: 'Rapid innovation and quick market response capability that outpaces competition' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'Strong relationships and values-based loyalty that creates lasting connections' }
                }
            },

            // PAGE 7: Questions 31-35 (Mixed Navigation/Archetype Integration)
            {
                id: 'q31',
                text: 'When assessing risks, you emphasize:',
                options: {
                    a: { type: 'Depth Navigator', operating: 'analytical', text: 'Thorough analysis of all potential long-term consequences' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Quick assessment with ability to adjust rapidly as things change' },
                    c: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic categorization with organized mitigation strategies' },
                    d: { type: 'Culture Navigator', operating: 'relational', text: 'How risks might affect people and relationships' }
                }
            },
            {
                id: 'q32',
                text: 'When implementing strategic initiatives, you prioritize:',
                options: {
                    a: { type: 'Speed Navigator', operating: 'adaptive', text: 'Rapid deployment with quick wins and fast iteration for momentum' },
                    b: { type: 'Culture Navigator', operating: 'relational', text: 'People engagement and change management throughout implementation' },
                    c: { type: 'Depth Navigator', operating: 'analytical', text: 'Thorough preparation and comprehensive planning with detailed analysis' },
                    d: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic rollout with organized phases and milestone tracking' }
                }
            },
            {
                id: 'q33',
                text: 'Your approach to innovation involves:',
                options: {
                    a: { type: 'Culture Navigator', operating: 'relational', text: 'Building innovative culture and collaborative creative environments' },
                    b: { type: 'Speed Navigator', operating: 'adaptive', text: 'Rapid prototyping and quick market testing with fast iteration' },
                    c: { type: 'Depth Navigator', operating: 'analytical', text: 'Deep research and comprehensive development with thorough validation' },
                    d: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic innovation processes with organized development pipelines' }
                }
            },
            {
                id: 'q34',
                text: 'When evaluating strategic opportunities, you emphasize:',
                options: {
                    a: { type: 'Speed Navigator', operating: 'adaptive', text: 'Time-to-market and ability to capitalize quickly before competitors' },
                    b: { type: 'Culture Navigator', operating: 'relational', text: 'Values alignment and positive impact on people and culture' },
                    c: { type: 'Depth Navigator', operating: 'analytical', text: 'Comprehensive due diligence and long-term risk assessment with thorough analysis' },
                    d: { type: 'Scale Navigator', operating: 'structured', text: 'Systematic evaluation with organized comparison using structured criteria' }
                }
            },
            {
                id: 'q35',
                text: 'When measuring success, you focus most on:',
                options: {
                    a: { type: 'Culture Navigator', operating: 'relational', text: 'Whether people are satisfied and relationships are strong' },
                    b: { type: 'Depth Navigator', operating: 'analytical', text: 'Whether your insights and predictions turned out to be accurate' },
                    c: { type: 'Speed Navigator', operating: 'adaptive', text: 'How quickly you executed and achieved your objectives' },
                    d: { type: 'Scale Navigator', operating: 'structured', text: 'Whether you hit your milestones and made measurable progress' }
                }
            },

            // PAGE 8: Questions 36-40 (Authenticity Alignment I)
            {
                id: 'q36',
                text: 'When reflecting on your current professional role, you feel:',
                options: {
                    a: { clarity: 4, text: 'Completely energized and operating from your authentic strengths on a daily basis' },
                    b: { clarity: 3, text: 'Generally aligned with occasional moments of feeling mismatched, drained, or inauthentic' },
                    c: { clarity: 2, text: 'Conflicted between performing well professionally and feeling authentic to your true self' },
                    d: { clarity: 1, text: 'Constantly performing a version of yourself that doesn\'t feel genuine or sustainable' }
                }
            },
            {
                id: 'q37',
                text: 'The gap between your authentic self and professional expectations feels:',
                options: {
                    a: { clarity: 4, text: 'Minimal - you can be completely genuine while meeting all professional expectations' },
                    b: { clarity: 3, text: 'Small - occasional adjustments needed but generally authentic expression is possible' },
                    c: { clarity: 2, text: 'Significant - regular tension between authenticity and performance pressure creates internal conflict' },
                    d: { clarity: 1, text: 'Major - constant performance of an inauthentic professional persona that feels exhausting' }
                }
            },
            {
                id: 'q38',
                text: 'Your sense of professional fulfillment depends primarily on:',
                options: {
                    a: { clarity: 4, text: 'Working in complete alignment with your core values and natural strengths every day' },
                    b: { clarity: 3, text: 'Mostly meaningful work with occasional compromises for practical necessities and constraints' },
                    c: { clarity: 2, text: 'Balancing meaningful elements with significant misaligned responsibilities and expectations' },
                    d: { clarity: 1, text: 'External validation and performance metrics rather than internal alignment and authentic contribution' }
                }
            },
            {
                id: 'q39',
                text: 'When envisioning your future, you feel most confident when:',
                options: {
                    a: { clarity: 4, text: 'Your vision aligns completely with your authentic strengths and core values' },
                    b: { clarity: 3, text: 'You can see a clear path that mostly honors your authentic self with some practical compromises' },
                    c: { clarity: 2, text: 'You hope to find ways to express your authentic strengths within traditional success metrics' },
                    d: { clarity: 1, text: 'You focus on external achievements and status markers rather than internal alignment' }
                }
            },
            {
                id: 'q40',
                text: 'Your daily work energy and motivation comes from:',
                options: {
                    a: { clarity: 4, text: 'Natural alignment between your core strengths and daily responsibilities and contributions' },
                    b: { clarity: 3, text: 'Mostly meaningful work with occasional tasks that feel draining or misaligned' },
                    c: { clarity: 2, text: 'Mix of energizing and draining activities that creates inconsistent motivation patterns' },
                    d: { clarity: 1, text: 'External pressure and performance expectations rather than internal motivation and authentic interest' }
                }
            },

            // PAGE 9: Questions 41-45 (Authenticity Alignment II)
            {
                id: 'q41',
                text: 'Your stress levels typically increase when work requires:',
                options: {
                    a: { clarity: 1, text: 'Extended time operating outside your natural strengths and authentic contribution style' },
                    b: { clarity: 2, text: 'Occasional compromise of your values or authentic expression for organizational demands' },
                    c: { clarity: 3, text: 'Minor adjustments to your natural approach while maintaining most authentic expression' },
                    d: { clarity: 4, text: 'Complete alignment between your natural strengths and daily work requirements' }
                }
            },
            {
                id: 'q42',
                text: 'Your career satisfaction is most dependent on:',
                options: {
                    a: { clarity: 4, text: 'Being able to contribute authentically using your natural strengths and core values daily' },
                    b: { clarity: 3, text: 'Finding meaningful work that allows significant authentic expression with minimal compromise' },
                    c: { clarity: 2, text: 'Balancing authentic contribution with necessary but misaligned professional responsibilities' },
                    d: { clarity: 1, text: 'Meeting external performance standards regardless of personal fulfillment or authentic expression' }
                }
            },
            {
                id: 'q43',
                text: 'Your definition of professional success prioritizes:',
                options: {
                    a: { clarity: 4, text: 'Creating meaningful impact through work that aligns with your deepest values and natural talents' },
                    b: { clarity: 3, text: 'Achieving significant results while maintaining authentic expression and personal integrity' },
                    c: { clarity: 2, text: 'Building a successful career while hoping to find opportunities for more authentic contribution' },
                    d: { clarity: 1, text: 'Reaching traditional career milestones and external recognition regardless of personal fulfillment' }
                }
            },
            {
                id: 'q44',
                text: 'When making career decisions, you are guided primarily by:',
                options: {
                    a: { clarity: 4, text: 'Perfect alignment between opportunities and your authentic strengths, values, and natural contribution patterns' },
                    b: { clarity: 3, text: 'Strong alignment with occasional strategic compromises for growth opportunities and practical considerations' },
                    c: { clarity: 2, text: 'Balancing authentic interests with practical career advancement and financial security requirements' },
                    d: { clarity: 1, text: 'External opportunities and advancement potential regardless of fit with your authentic self' }
                }
            },
            {
                id: 'q45',
                text: 'The relationship between your authentic self and professional identity feels:',
                options: {
                    a: { clarity: 4, text: 'Seamlessly integrated - your professional work is a natural expression of who you authentically are' },
                    b: { clarity: 3, text: 'Mostly integrated with occasional situations requiring minor persona adjustments for professional effectiveness' },
                    c: { clarity: 2, text: 'Requiring significant energy to maintain professional persona that differs from your authentic self' },
                    d: { clarity: 1, text: 'Completely separate - professional success requires performing as someone fundamentally different from your true self' }
                }
            },

            // PAGE 10: Questions 46-50 (Growth Catalysts)
            {
                id: 'q46',
                text: 'You grow best in environments that provide:',
                options: {
                    a: { growth: 'environment', text: 'Structured learning with clear development paths' },
                    b: { growth: 'mentorship', text: 'Access to experienced mentors who can guide you' },
                    c: { growth: 'challenge', text: 'Challenging assignments that push you beyond your comfort zone' },
                    d: { growth: 'autonomy', text: 'Freedom to experiment and develop your own approaches' }
                }
            },
            {
                id: 'q47',
                text: 'The leadership development that would help you grow fastest:',
                options: {
                    a: { growth: 'environment', text: 'Immersive programs with structured skill-building curricula' },
                    b: { growth: 'mentorship', text: 'One-on-one coaching with experienced leaders' },
                    c: { growth: 'challenge', text: 'High-stakes opportunities that force you to develop new skills quickly' },
                    d: { growth: 'autonomy', text: 'Self-directed development where you design your own learning path' }
                }
            },
            {
                id: 'q48',
                text: 'Your biggest breakthroughs typically happen through:',
                options: {
                    a: { growth: 'challenge', text: 'Demanding situations that force you to develop new capabilities' },
                    b: { growth: 'mentorship', text: 'Insights and guidance from experienced mentors' },
                    c: { growth: 'environment', text: 'Structured learning environments with clear development frameworks' },
                    d: { growth: 'autonomy', text: 'Independent exploration where you discover your own approaches' }
                }
            },
            {
                id: 'q49',
                text: 'What would unlock your next level of potential most:',
                options: {
                    a: { growth: 'environment', text: 'An organizational culture with strong development support systems' },
                    b: { growth: 'mentorship', text: 'Strategic relationships with people who can guide your growth' },
                    c: { growth: 'challenge', text: 'Ambitious goals that stretch your capabilities and require significant growth' },
                    d: { growth: 'autonomy', text: 'More authority and freedom to implement your vision' }
                }
            },
            {
                id: 'q50',
                text: 'Your ability to perform at a high level long-term depends on:',
                options: {
                    a: { growth: 'autonomy', text: 'Having control over your approach and freedom to work naturally' },
                    b: { growth: 'environment', text: 'Supportive systems and culture that amplify your contributions' },
                    c: { growth: 'mentorship', text: 'Ongoing relationships with advisors who provide guidance and perspective' },
                    d: { growth: 'challenge', text: 'Regular opportunities to tackle meaningful, challenging problems' }
                }
            }
        ];

        // Section definitions to organize questions
        const sections = [
            { title: 'Natural Impact Patterns', subtitle: 'How you naturally create meaningful results and influence', start: 1, end: 15 },
            { title: 'Navigation & Performance Style', subtitle: 'How you handle complexity and drive results', start: 16, end: 35 },
            { title: 'Authenticity & Alignment', subtitle: 'How aligned you are with your authentic strengths', start: 36, end: 45 },
            { title: 'Growth Catalysts', subtitle: 'What accelerates your development and potential', start: 46, end: 50 }
        ];

        // Profile definitions
        const profileDefinitions = {
            'Builder + Depth Navigator': {
                title: 'The Master Architect',
                insight: 'You combine visionary building capability with deep analytical thinking. You create comprehensive, lasting systems by thoroughly understanding complex domains and designing sustainable solutions.'
            },
            'Builder + Speed Navigator': {
                title: 'The Rapid Builder', 
                insight: 'You excel at quickly establishing functional systems and structures. You move fast to create order and organization while maintaining focus on practical implementation.'
            },
            'Builder + Scale Navigator': {
                title: 'The System Scaler',
                insight: 'You specialize in building systematic, repeatable processes that can grow and scale efficiently. You create frameworks that work consistently across multiple contexts.'
            },
            'Builder + Culture Navigator': {
                title: 'The Culture Architect',
                insight: 'You build systems and structures that honor human dynamics and create environments where people can thrive authentically while achieving organizational goals.'
            },
            'Bridger + Depth Navigator': {
                title: 'The Wisdom Connector',
                insight: 'You bridge people and ideas through deep understanding and comprehensive knowledge. You facilitate meaningful connections by seeing the deeper patterns and implications.'
            },
            'Bridger + Speed Navigator': {
                title: 'The Rapid Connector',
                insight: 'You quickly identify and create valuable connections between people, ideas, and opportunities. You excel at fast relationship building and dynamic collaboration.'
            },
            'Bridger + Scale Navigator': {
                title: 'The Connection Multiplier',
                insight: 'You systematically build networks and relationships that scale impact. You create organized approaches to collaboration that multiply collective potential.'
            },
            'Bridger + Culture Navigator': {
                title: 'The Community Weaver',
                insight: 'You build authentic, lasting relationships and communities. You focus on creating inclusive environments where diverse perspectives contribute to collective success.'
            },
            'Breaker + Depth Navigator': {
                title: 'The Systems Solver',
                insight: 'You analyze complex problems thoroughly to develop comprehensive, strategic solutions. You excel at understanding root causes and creating lasting fixes.'
            },
            'Breaker + Speed Navigator': {
                title: 'The Rapid Resolver',
                insight: 'You quickly diagnose and resolve complex challenges through fast analysis and adaptive response. You excel in dynamic problem-solving environments.'
            },
            'Breaker + Scale Navigator': {
                title: 'The Complexity Conqueror',
                insight: 'You systematically break down and solve complex challenges through organized analytical approaches. You create scalable problem-solving frameworks.'
            },
            'Breaker + Culture Navigator': {
                title: 'The Cultural Problem Solver',
                insight: 'You solve complex problems while considering human and cultural dynamics. You ensure solutions work for both systems and people.'
            },
            'Blazer + Depth Navigator': {
                title: 'The Paradigm Pioneer',
                insight: 'You challenge conventional thinking through deep expertise and comprehensive analysis. You create breakthrough innovations based on thorough understanding.'
            },
            'Blazer + Speed Navigator': {
                title: 'The Breakthrough Catalyst',
                insight: 'You drive rapid innovation and transformational change. You excel at quickly identifying and capitalizing on opportunities for breakthrough results.'
            },
            'Blazer + Scale Navigator': {
                title: 'The Revolution Architect',
                insight: 'You systematically design and implement transformational change. You create organized approaches to innovation that scale and sustain impact.'
            },
            'Blazer + Culture Navigator': {
                title: 'The Cultural Revolutionary',
                insight: 'You drive transformation by understanding and leveraging human dynamics. You create lasting change that honors people while achieving breakthrough results.'
            }
        };

        // ============================================
        // ACCESS CODE VALIDATION
        // ============================================
        async function validateAccessCode(event) {
            event.preventDefault();
            
            const code = document.getElementById('accessCodeInput').value.trim().toUpperCase();
            const errorDiv = document.getElementById('accessCodeError');
            const validateBtn = document.getElementById('validateBtn');
            
            // Clear previous errors
            errorDiv.style.display = 'none';
            validateBtn.disabled = true;
            validateBtn.textContent = 'Validating...';
            
            try {
                // Check if access code exists and is not used
                const { data, error } = await supabase
                    .from('access_codes')
                    .select('*')
                    .eq('code', code)
                    .single();
                
                if (error || !data) {
                    throw new Error('Invalid access code. Please check your code and try again.');
                }
                
                // Check if code has already been used
                if (data.used) {
                    throw new Error('This access code has already been used. Each code can only be used once.');
                }
                
                // Code is valid and unused!
                validatedAccessCode = code;
                cohortBatch = data.cohort_batch;
                
                // Mark code as used and store user info
                await supabase
                    .from('access_codes')
                    .update({ 
                        used: true,
                        used_at: new Date().toISOString()
                    })
                    .eq('code', code);
                
                // Hide access code screen, show main assessment
                document.getElementById('accessCodeScreen').style.display = 'none';
                document.getElementById('mainAssessment').style.display = 'block';
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
            } catch (error) {
                console.error('Error validating access code:', error);
                errorDiv.textContent = error.message;
                errorDiv.style.display = 'block';
                validateBtn.disabled = false;
                validateBtn.textContent = 'Validate & Continue';
            }
        }

        function showUserInfo() {
            document.getElementById('introPage').style.display = 'none';
            document.getElementById('userInfoPage').style.display = 'block';
        }

        function startAssessment() {
            const name = document.getElementById('userName').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            
            if (!name || !email) {
                alert('Please enter both your name and email address.');
                return;
            }
            
            if (!email.includes('@') || !email.includes('.')) {
                alert('Please enter a valid email address.');
                return;
            }

            userData.name = name;
            userData.email = email;

            // Update access code with user information
            supabase
                .from('access_codes')
                .update({ 
                    used_by_name: name,
                    used_by_email: email
                })
                .eq('code', validatedAccessCode)
                .then(() => {
                    document.getElementById('userInfoPage').style.display = 'none';
                    document.getElementById('assessmentContainer').style.display = 'block';
                    
                    currentPage = 0;
                    loadPage();
                });
        }

        function loadPage() {
            const startQ = currentPage * questionsPerPage;
            const endQ = Math.min(startQ + questionsPerPage, questions.length);
            const progressPercent = ((currentPage + 1) / totalPages) * 100;
            
            // Scroll to top - multiple methods for reliability
            const topAnchor = document.getElementById('top-anchor');
            if (topAnchor) {
                topAnchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // Also try window scroll
            window.scrollTo({ top: 0, behavior: 'smooth' });
            document.body.scrollTop = 0; // For Safari
            document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
            
            // Message parent (for Wix)
            if (window.parent) {
                window.parent.postMessage({ type: 'scroll-to-top' }, '*');
            }
            
            // Update progress
            document.getElementById('progressFill').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = `Page ${currentPage + 1} of ${totalPages}`;
            
            // Update section header
            const currentSection = sections.find(section => 
                startQ + 1 >= section.start && startQ + 1 <= section.end
            );
            
            if (currentSection) {
                document.getElementById('sectionTitle').textContent = currentSection.title;
                document.getElementById('sectionSubtitle').textContent = currentSection.subtitle;
            }
            
            // Load questions for this page
            const container = document.getElementById('pageContainer');
            container.innerHTML = '';
            
            for (let i = startQ; i < endQ; i++) {
                const question = questions[i];
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-item';
                
                questionDiv.innerHTML = `
                    <div class="question-number">Question ${i + 1}</div>
                    <div class="question-text">${question.text}</div>
                    <div class="options-container" data-question-id="${question.id}">
                        ${Object.entries(question.options).map(([key, option]) => 
                            `<div class="option" data-question-id="${question.id}" data-option-key="${key}" onclick="selectOption('${question.id}', '${key}', this)">
                                <div class="option-circle"></div>
                                <div class="option-text">${option.text}</div>
                            </div>`
                        ).join('')}
                    </div>
                `;
                
                container.appendChild(questionDiv);
            }
            
            // Update navigation
            document.getElementById('prevBtn').style.visibility = currentPage > 0 ? 'visible' : 'hidden';
            document.getElementById('nextBtn').disabled = true;
            document.getElementById('nextBtn').textContent = currentPage === totalPages - 1 ? 'Complete Assessment' : 'Next Page';
            
            checkPageCompletion();
        }

        function selectOption(questionId, optionKey, element) {
            // Remove selection from other options for this question
            document.querySelectorAll(`[data-question-id="${questionId}"].option`).forEach(opt => 
                opt.classList.remove('selected')
            );
            
            // Add selection to clicked option
            element.classList.add('selected');
            
            // Store response
            const question = questions.find(q => q.id === questionId);
            const option = question.options[optionKey];
            responses[questionId] = { key: optionKey, option };
            
            // Update scores
            updateScores(option);
            
            // Check if page is complete
            checkPageCompletion();
        }

        function checkPageCompletion() {
            const startQ = currentPage * questionsPerPage;
            const endQ = Math.min(startQ + questionsPerPage, questions.length);
            let completedQuestions = 0;
            
            for (let i = startQ; i < endQ; i++) {
                const questionId = questions[i].id;
                if (responses[questionId]) {
                    completedQuestions++;
                }
            }
            
            document.getElementById('nextBtn').disabled = completedQuestions < (endQ - startQ);
        }

        function updateScores(option) {
            // B-Archetype scoring (also updates Activation Patterns)
            if (option.type && scores.hasOwnProperty(option.type)) {
                scores[option.type] += 1;
            }
            
            // Navigation Style scoring (also updates Operating Zone)
            if (option.type && option.type.includes('Navigator')) {
                scores[option.type] += 1;
            }
            
            // Clarity Quotient scoring
            if (option.clarity !== undefined) {
                scores['Clarity Quotient'] += option.clarity;
            }
            
            // Growth Catalysts scoring
            if (option.growth) {
                scores['Growth Catalysts'][option.growth] += 1;
            }
        }

        function nextPage() {
            if (currentPage < totalPages - 1) {
                currentPage++;
                loadPage();
            } else {
                completeAssessment();
            }
        }

        function previousPage() {
            if (currentPage > 0) {
                currentPage--;
                loadPage();
            }
        }

        function completeAssessment() {
            document.getElementById('assessmentContainer').style.display = 'none';
            document.getElementById('loadingContainer').style.display = 'block';
            
            setTimeout(async () => {
                const results = calculateResults();
                
                // Save to Supabase
                try {
                    await saveToSupabase(results);
                    console.log('✅ Results saved to Supabase successfully');
                    console.log('Access Code:', validatedAccessCode);
                    console.log('Cohort Batch:', cohortBatch);
                    console.log('User:', userData.name, userData.email);
                } catch (error) {
                    console.error('❌ Error saving to Supabase:', error);
                    console.error('Full error details:', JSON.stringify(error, null, 2));
                    alert('⚠️ Warning: There was an issue saving your results to the database. Error: ' + error.message + '\n\nPlease screenshot this and contact info@empowerpotential.co');
                }
                
                showResults(results);
            }, 3000);
        }

        function calculateResults() {
            // Determine primary B-Archetype
            const archetypes = ['Builder', 'Bridger', 'Breaker', 'Blazer'];
            const primaryArchetype = archetypes.reduce((a, b) => scores[a] > scores[b] ? a : b);
            
            // Determine primary Navigation Style
            const navigators = ['Depth Navigator', 'Speed Navigator', 'Scale Navigator', 'Culture Navigator'];
            const primaryNavigator = navigators.reduce((a, b) => scores[a] > scores[b] ? a : b);
            
            // Calculate Clarity Quotient (percentage)
            const clarityQuotient = Math.round((scores['Clarity Quotient'] / 40) * 100); // 10 clarity questions * 4 max points
            
            // Calculate primary Growth Catalyst
            const growthCatalysts = Object.keys(scores['Growth Catalysts']);
            const primaryGrowth = growthCatalysts.reduce((a, b) => 
                scores['Growth Catalysts'][a] > scores['Growth Catalysts'][b] ? a : b);
            
            // Derive Activation Pattern from B-Archetype
            const activationMap = {
                'Builder': 'systems',
                'Blazer': 'innovation', 
                'Bridger': 'relationships',
                'Breaker': 'analysis'
            };
            const primaryActivation = activationMap[primaryArchetype];
            
            // Derive Operating Zone from Navigation Style
            const operatingMap = {
                'Depth Navigator': 'analytical',
                'Speed Navigator': 'adaptive',
                'Scale Navigator': 'structured', 
                'Culture Navigator': 'relational'
            };
            const primaryOperating = operatingMap[primaryNavigator];
            
            const profileKey = `${primaryArchetype} + ${primaryNavigator}`;
            const profileDef = profileDefinitions[profileKey] || {
                title: `${primaryArchetype} ${primaryNavigator}`,
                insight: "You have a unique combination of strengths that creates distinctive value."
            };
            
            return {
                archetype: primaryArchetype,
                navigator: primaryNavigator,
                profileTitle: profileDef.title,
                profileInsight: profileDef.insight,
                clarityQuotient: clarityQuotient,
                primaryGrowth: primaryGrowth,
                primaryActivation: primaryActivation,
                primaryOperating: primaryOperating,
                allScores: scores
            };
        }

        async function saveToSupabase(results) {
            // Generate profile code
            const archetypeMap = { 'Builder': 'B', 'Bridger': 'R', 'Breaker': 'K', 'Blazer': 'Z' };
            const navigatorMap = { 
                'Depth Navigator': 'D', 
                'Speed Navigator': 'S', 
                'Scale Navigator': 'C', 
                'Culture Navigator': 'L' 
            };
            const profileCode = archetypeMap[results.archetype] + navigatorMap[results.navigator];
            
            // Calculate percentages
            const totalArchetypeScore = scores.Builder + scores.Bridger + scores.Breaker + scores.Blazer;
            const totalNavigatorScore = scores['Depth Navigator'] + scores['Speed Navigator'] + scores['Scale Navigator'] + scores['Culture Navigator'];
            
            const archetypePercentages = {
                Builder: Math.round((scores.Builder / totalArchetypeScore) * 100),
                Bridger: Math.round((scores.Bridger / totalArchetypeScore) * 100),
                Breaker: Math.round((scores.Breaker / totalArchetypeScore) * 100),
                Blazer: Math.round((scores.Blazer / totalArchetypeScore) * 100)
            };
            
            const navigatorPercentages = {
                'Depth Navigator': Math.round((scores['Depth Navigator'] / totalNavigatorScore) * 100),
                'Speed Navigator': Math.round((scores['Speed Navigator'] / totalNavigatorScore) * 100),
                'Scale Navigator': Math.round((scores['Scale Navigator'] / totalNavigatorScore) * 100),
                'Culture Navigator': Math.round((scores['Culture Navigator'] / totalNavigatorScore) * 100)
            };
            
            // Determine clarity level
            let clarityLevel;
            if (results.clarityQuotient >= 70) clarityLevel = 'high';
            else if (results.clarityQuotient >= 40) clarityLevel = 'medium';
            else clarityLevel = 'low';
            
            const { data, error } = await supabase
                .from('cohort_profiles')
                .insert({
                    name: userData.name,
                    email: userData.email,
                    access_code: validatedAccessCode,
                    cohort_batch: cohortBatch,
                    primary_archetype: results.archetype,
                    primary_navigator: results.navigator,
                    profile_combination: results.profileTitle,
                    profile_code: profileCode,
                    activation_pattern: results.primaryActivation,
                    operating_zone: results.primaryOperating,
                    clarity_quotient: results.clarityQuotient,
                    clarity_level: clarityLevel,
                    primary_growth_catalyst: results.primaryGrowth,
                    archetype_scores: {
                        builder: scores.Builder,
                        bridger: scores.Bridger,
                        breaker: scores.Breaker,
                        blazer: scores.Blazer
                    },
                    archetype_percentages: archetypePercentages,
                    navigator_scores: {
                        depth: scores['Depth Navigator'],
                        speed: scores['Speed Navigator'],
                        scale: scores['Scale Navigator'],
                        culture: scores['Culture Navigator']
                    },
                    navigator_percentages: navigatorPercentages,
                    growth_catalyst_scores: scores['Growth Catalysts'],
                    assessment_responses: responses,
                    created_at: new Date().toISOString()
                });

            if (error) {
                throw error;
            }

            return data;
        }

        function showResults(results) {
            document.getElementById('loadingContainer').style.display = 'none';
            document.getElementById('resultsPage').style.display = 'block';
            
            // Scroll to top - multiple methods
            const topAnchor = document.getElementById('top-anchor');
            if (topAnchor) {
                topAnchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
            
            if (window.parent) {
                window.parent.postMessage({ type: 'scroll-to-top' }, '*');
            }
            
            // Update results display
            document.getElementById('userNameDisplay').textContent = userData.name;
            document.getElementById('profileDisplay').textContent = results.profileTitle;
            document.getElementById('profileInsight').textContent = results.profileInsight;
            document.getElementById('emailDisplay').textContent = userData.email;
            
            // Create breakdown items with capitalized values
            const breakdownGrid = document.getElementById('breakdownGrid');
            breakdownGrid.innerHTML = `
                <div class="breakdown-item">
                    <h4>Primary Archetype</h4>
                    <p><strong>${results.archetype}:</strong> Your core impact pattern and how you naturally create value in the world.</p>
                </div>
                <div class="breakdown-item">
                    <h4>Navigation Style</h4>
                    <p><strong>${results.navigator}:</strong> How you process complexity and drive results in challenging environments.</p>
                </div>
                <div class="breakdown-item">
                    <h4>Activation Pattern</h4>
                    <p><strong>${results.primaryActivation.charAt(0).toUpperCase() + results.primaryActivation.slice(1)}:</strong> The mechanism through which you naturally engage and create impact.</p>
                </div>
                <div class="breakdown-item">
                    <h4>Operating Zone</h4>
                    <p><strong>${results.primaryOperating.charAt(0).toUpperCase() + results.primaryOperating.slice(1)}:</strong> The environment and approach where you perform at your highest level.</p>
                </div>
                <div class="breakdown-item">
                    <h4>Clarity Quotient</h4>
                    <p><strong>${results.clarityQuotient}%:</strong> How aligned your current role is with your authentic strengths and values.</p>
                </div>
                <div class="breakdown-item">
                    <h4>Growth Catalyst</h4>
                    <p><strong>${results.primaryGrowth.charAt(0).toUpperCase() + results.primaryGrowth.slice(1)}:</strong> The primary condition that accelerates your development and unlocks potential.</p>
                </div>
            `;
        }

        function showDetailedResults() {
            // Get the latest results
            const results = calculateResults();
            
            // Update detailed modal content
            document.getElementById('detailedProfileTitle').innerHTML = `<strong>${results.profileTitle}</strong>`;
            document.getElementById('detailedProfileInsight').textContent = results.profileInsight;
            
            // Populate archetype scores
            const archetypeGrid = document.getElementById('archetypeScores');
            const archetypes = ['Builder', 'Bridger', 'Breaker', 'Blazer'];
            const totalArchetype = archetypes.reduce((sum, type) => sum + scores[type], 0);
            
            archetypeGrid.innerHTML = archetypes.map(type => {
                const percentage = Math.round((scores[type] / totalArchetype) * 100);
                return `
                    <div class="score-item">
                        <div class="score-value">${percentage}%</div>
                        <div class="score-label">${type}</div>
                    </div>
                `;
            }).join('');
            
            // Populate navigator scores
            const navigatorGrid = document.getElementById('navigatorScores');
            const navigators = ['Depth Navigator', 'Speed Navigator', 'Scale Navigator', 'Culture Navigator'];
            const totalNavigator = navigators.reduce((sum, type) => sum + scores[type], 0);
            
            navigatorGrid.innerHTML = navigators.map(type => {
                const percentage = Math.round((scores[type] / totalNavigator) * 100);
                return `
                    <div class="score-item">
                        <div class="score-value">${percentage}%</div>
                        <div class="score-label">${type.replace(' Navigator', '')}</div>
                    </div>
                `;
            }).join('');
            
            // Populate growth scores
            const growthGrid = document.getElementById('growthScores');
            const growthCatalysts = Object.keys(scores['Growth Catalysts']);
            const totalGrowth = growthCatalysts.reduce((sum, type) => sum + scores['Growth Catalysts'][type], 0);
            
            growthGrid.innerHTML = growthCatalysts.map(type => {
                const score = scores['Growth Catalysts'][type];
                const percentage = totalGrowth > 0 ? Math.round((score / totalGrowth) * 100) : 0;
                return `
                    <div class="score-item">
                        <div class="score-value">${percentage}%</div>
                        <div class="score-label">${type.charAt(0).toUpperCase() + type.slice(1)}</div>
                    </div>
                `;
            }).join('');
            
            // Update key insights
            let clarityLevel = 'High';
            let clarityColor = '#10B981';
            if (results.clarityQuotient < 70) { clarityLevel = 'Medium'; clarityColor = '#F59E0B'; }
            if (results.clarityQuotient < 40) { clarityLevel = 'Developing'; clarityColor = '#EF4444'; }
            
            document.getElementById('clarityInsight').innerHTML = `<span style="color: ${clarityColor}; font-weight: 600;">${results.clarityQuotient}% - ${clarityLevel} Alignment</span>`;
            document.getElementById('growthInsight').textContent = `${results.primaryGrowth.charAt(0).toUpperCase() + results.primaryGrowth.slice(1)}-based development accelerates your growth most effectively`;
            document.getElementById('zoneInsight').textContent = `You perform best in ${results.primaryOperating} environments that honor your natural processing style`;
            
            // Show modal
            document.getElementById('detailedResultsModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeDetailedResults() {
            document.getElementById('detailedResultsModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('detailedResultsModal');
            if (event.target === modal) {
                closeDetailedResults();
            }
        });


        // Initialize the assessment
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ROOTED Cohort - Complete Potential Profile Assessment loaded');
            
            // Iframe height auto-adjustment
            function sendHeight() {
                const height = document.body.scrollHeight;
                window.parent.postMessage({
                    type: 'iframe-height',
                    height: height
                }, '*');
            }
            
            // Send height on load and when content changes
            sendHeight();
            
            // Monitor for content changes
            const observer = new MutationObserver(sendHeight);
            observer.observe(document.body, {
                childList: true,
                subtree: true,
                attributes: true
            });
            
            // Also send on window resize
            window.addEventListener('resize', sendHeight);
        });
    </script>
</body>
</html>